<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ReuniteAI — Report Found Items</title>
  <link rel="stylesheet" href="./styles/style.css" />
  <link rel="stylesheet" href="./styles/report.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap"
    rel="stylesheet" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.css"/>
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script src="https://kit.fontawesome.com/cdfe75faaa.js" crossorigin="anonymous"></script>
  <link rel="preload" as="script" href="https://witty-mink-37.clerk.accounts.dev/npm/@clerk/clerk-js@5/dist/clerk.browser.js" crossorigin="anonymous">
  <script
    async
    crossorigin="anonymous"
    data-clerk-publishable-key="pk_test_d2l0dHktbWluay0zNy5jbGVyay5hY2NvdW50cy5kZXYk"
    src="https://witty-mink-37.clerk.accounts.dev/npm/@clerk/clerk-js@5/dist/clerk.browser.js"
    type="text/javascript"
  ></script>
  <script src="./scripts/auth.js" defer></script>
</head>

<body>
  <header>
    <nav class="navbar">
      <div class="nav-section nav-left">
        <div class="logo">
          <a href="./index.html">ReuniteAI</a>
        </div>
      </div>
      <div class="nav-section nav-center">
        <a href="#">How It Works</a>
        <a href="#">About</a>
        <a href="#">Check Report Status</a>
      </div>
      
      <div id="signed-out-nav" class="nav-section nav-right" style="display: none;">
        <a href="#" id="login-button" class="nav-auth">Log in</a>
        <a href="#" id="signup-button" class="nav-auth outlined">Sign up</a>
      </div>

      <div id="signed-in-nav" class="nav-section nav-right">
        <div class="notification-wrapper">
          <i class="fa-regular fa-bell notification-icon"></i>
          <span id="notification-badge" class="notification-badge">0</span>
          <div id="notification-dropdown" class="notification-dropdown" style="display: none;">
            <div class="notif-header">
              <h3>Notifications</h3>
            </div>
            
            <ul id="notification-list" class="notif-body">
              </ul>
          </div>
        </div>
        <a href="./dashboard.html" class="nav-auth outlined">My Dashboard</a>
        <div id="user-button"></div>
      </div>

    </nav>
  </header>

  <main>
    <section class="report-section">
      <h1 class="report-title">Found someone's item?</h1>
      <p class="report-subtitle">
        Help reunite them with it by reporting what you found.
      </p>

      <form id="" class="report-form" data-status="found">
        <div class="form-group">
          <label for="item-image">Upload a Photo of the Found item</label>
          <input type="file" id="item-image" accept="image/*" required aria-label="Upload photo of the found item" />
          <div id="image-preview" class="image-preview">
            <span id="crop-icon" class="crop-icon"><i class="fa-solid fa-crop-simple"></i></span>
          </div>
        </div>

        <div class="form-group">  
          <label for="item-description">Describe the item</label>
          <textarea id="item-description" placeholder="e.g., Red backpack, library, zipper broken" required
            aria-label="Description of found item"></textarea>
        </div>

        <div class="form-group">
          <label for="university-name">University</label>
          <input type="text" id="university-name" value="Federal University of Technology, Akure" readonly disabled
            aria-label="University name" />
          <input type="hidden" name="university" value="Federal University of Technology, Akure" />
        </div>

        <div class="form-group">
          <label for="item-location">
            Where did you found it?
            <div class="info-container">
              <i class="fa-solid fa-circle-info"></i>
              <span class="info-text">
                We try to detect the name of the place you click on, but it may not always be accurate. Feel free to correct it manually.
              </span>
            </div>
          </label>
          <p>Select on the map or type location manually</p>
          <div id="map"></div>
          <input type="text" name="custom-location"
            placeholder="E.g. LT1, Engineering Building, Obakekere, Malu Road" />
          <input type="hidden" name="lat" id="lat" />
          <input type="hidden" name="lng" id="lng" />
        </div>

        <div class="form-group">
          <label for="item-date">When did you find it?</label>
          <input type="date" id="item-date" required aria-label="Date the item was found" />
        </div>
        
        <div class="verification-section collapsible">
            <div class="collapsible-toggle">
                <div class="toggle-text-content">
                    <h3 class="verification-title">
                        <i class="fa-solid fa-shield-halved"></i>
                        Add a Security Question <span class="optional-text">(Optional)</span>
                    </h3>
                    <p class="verification-info">To prevent fraud, add a simple question about a unique detail of the item.</p>
                </div>
                <i class="fa-solid fa-chevron-down toggle-icon"></i>
            </div>
            <div class="collapsible-content">
                <div class="form-group">
                    <label for="verification-question">Verification Question</label>
                    <input type="text" id="verification-question" name="verification_question" placeholder="e.g., What's in the front pocket of the bag?" />
                </div>
                <div class="form-group">
                    <label for="verification-answer">Correct Answer</label>
                    <input type="text" id="verification-answer" name="verification_answer" placeholder="e.g., My old school ID and some pens" />
                </div>
            </div>
        </div>

        <button type="submit" class="submit-button">
          Submit Found Item Report
        </button>
      </form>

      <div id="successMessage" class="success-message" style="display: none">
        <p>
          Thanks! We’ve received your report. Our AI is now searching for apossible match with any missing item. We’ll notify you if there's a Match.
        </p>
        <a href="./index.html" class="back-button">Back to Home</a>
      </div>
    </section>
  </main>

  <!-- cropper modal -->
  <div id="crop-modal" class="modal" style="display: none;">
    <div class="modal-content">
      <span id="crop-close" class="close">&times;</span>
      <h3>Highlight the found item in the photo so we can reunite it faster</h3>
      <img id="crop-image" src="" alt="Crop area preview" style="max-width: 100%;" />
      <button id="crop-confirm" class="submit-button" style="margin-top: 12px;">Crop & Save</button>
    </div>
  </div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.js"></script>
<script src="./scripts/map.js"></script>
<script src="./scripts/report-form.js" defer></script>
</body>
</html>